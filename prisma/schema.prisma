// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// NUEVO: Modelo de Usuario
model User {
  id          String   @id @default(uuid())
  email       String   @unique
  name        String? // <--- NUEVO CAMPO: Para guardar el nombre real
  token       String // Aquí guardaremos tu "contraseña/token"
  householdId String // Identificador del grupo familiar
  createdAt   DateTime @default(now())
}

// ... (El resto de modelos Account, Category, etc. quedan IGUAL)
model Account {
  id           String        @id @default(uuid())
  householdId  String        @default("demo")
  name         String
  bank         String
  type         String
  owner        String
  balance      Float         @default(0)
  balanceSafe  Float    @default(0) // El saldo que corresponde a ahorro dentro de esta cuenta
  isHidden     Boolean       @default(false)
  color        String
  transactions Transaction[]
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Category {
  id            String        @id @default(uuid())
  householdId   String        @default("demo")
  name          String
  type          String
  subCategories String
  transactions  Transaction[]
}

model Transaction {
  id               String    @id @default(uuid())
  householdId      String    @default("demo")
  type             String
  amount           Float
  budgetedAmount   Float?
  accountId        String
  account          Account   @relation(fields: [accountId], references: [id], onDelete: Cascade)
  categoryId       String?
  category         Category? @relation(fields: [categoryId], references: [id])
  description      String    @db.VarChar(255)
  date             DateTime
  isFixed          Boolean   @default(false)
  isSavings        Boolean   @default(false)
  isTransfer       Boolean   @default(false)
  didWithdraw      Boolean   @default(true)
  payWithSavings   Boolean   @default(false)
  relatedAccountId String?
}

model FixedRule {
  id                String  @id @default(uuid())
  householdId       String  @default("demo")
  description       String
  categoryId        String
  budgetedAmount    Float
  dayOfMonth        Int
  accountIdToCharge String
  isActive          Boolean @default(true)
}

model SimulatorItem {
  id          String  @id @default(uuid())
  householdId String  @default("demo")
  name        String
  amount      Float
  type        String
  isFixed     Boolean @default(false)
}

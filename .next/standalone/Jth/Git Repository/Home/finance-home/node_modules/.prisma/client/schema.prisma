// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Account {
  id           String        @id @default(uuid())
  name         String
  bank         String
  type         String // 'bank', 'wallet', 'cash', 'savings_virtual'
  owner        String
  balance      Float         @default(0)
  isHidden     Boolean       @default(false)
  color        String
  transactions Transaction[]
}

model Category {
  id            String        @id @default(uuid())
  name          String
  type          String
  subCategories String
  transactions  Transaction[]
}

model Transaction {
  id             String @id @default(uuid())
  type           String // 'income', 'expense', 'transfer'
  amount         Float
  budgetedAmount Float?

  accountId String
  account   Account @relation(fields: [accountId], references: [id], onDelete: Cascade)

  categoryId String? // Opcional para transferencias
  category   Category? @relation(fields: [categoryId], references: [id])

  description String
  date        DateTime

  // Nuevos campos lógicos
  isFixed    Boolean @default(false)
  isSavings  Boolean @default(false)
  isTransfer Boolean @default(false)

  // Lógica de Ahorro Virtual (No se retira)
  didWithdraw Boolean @default(true) // true = se descontó el dinero

  // Para Transferencias
  relatedAccountId String? // A qué cuenta fue (si es salida) o de dónde vino (si es entrada)
}

model FixedRule {
  id                String  @id @default(uuid())
  description       String
  categoryId        String
  budgetedAmount    Float
  dayOfMonth        Int
  accountIdToCharge String
  isActive          Boolean @default(true)
}

model SimulatorItem {
  id      String  @id @default(uuid())
  name    String
  amount  Float
  type    String
  isFixed Boolean @default(false)
}
